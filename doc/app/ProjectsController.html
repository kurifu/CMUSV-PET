<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: ProjectsController</title>

	<link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

	<script src="./js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="./app/controllers/projects_controller_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="app/controllers/projects_controller.rb">app/controllers/projects_controller.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link"><a href="ApplicationController.html">ApplicationController</a></p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-i-create">#create</a></li>
					
					<li><a href="#method-i-destroy">#destroy</a></li>
					
					<li><a href="#method-i-edit">#edit</a></li>
					
					<li><a href="#method-i-error">#error</a></li>
					
					<li><a href="#method-i-index">#index</a></li>
					
					<li><a href="#method-i-is_num%3F">#is_num?</a></li>
					
					<li><a href="#method-i-log_hours">#log_hours</a></li>
					
					<li><a href="#method-i-new">#new</a></li>
					
					<li><a href="#method-i-overview">#overview</a></li>
					
					<li><a href="#method-i-show">#show</a></li>
					
					<li><a href="#method-i-update">#update</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="./README.html">README</a></li>
				
					<li class="file"><a href="./doc/DESIGN_DECISION.html">DESIGN_DECISION</a></li>
				
					<li class="file"><a href="./doc/README_FOR_APP.html">README_FOR_APP</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="./images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="./AboutUsController.html">AboutUsController</a></li>
				
					<li><a href="./ApplicationController.html">ApplicationController</a></li>
				
					<li><a href="./ApplicationHelper.html">ApplicationHelper</a></li>
				
					<li><a href="./ContactController.html">ContactController</a></li>
				
					<li><a href="./Deliverable.html">Deliverable</a></li>
				
					<li><a href="./DeliverableTypeController.html">DeliverableTypeController</a></li>
				
					<li><a href="./DeliverableTypeHelper.html">DeliverableTypeHelper</a></li>
				
					<li><a href="./DeliverablesController.html">DeliverablesController</a></li>
				
					<li><a href="./DeliverablesHelper.html">DeliverablesHelper</a></li>
				
					<li><a href="./HelpController.html">HelpController</a></li>
				
					<li><a href="./Project.html">Project</a></li>
				
					<li><a href="./ProjectsController.html">ProjectsController</a></li>
				
					<li><a href="./ProjectsHelper.html">ProjectsHelper</a></li>
				
					<li><a href="./RailblazersXmlParser.html">RailblazersXmlParser</a></li>
				
					<li><a href="./User.html">User</a></li>
				
					<li><a href="./UserSession.html">UserSession</a></li>
				
					<li><a href="./UserSessionHelper.html">UserSessionHelper</a></li>
				
					<li><a href="./UserSessionsController.html">UserSessionsController</a></li>
				
					<li><a href="./UserSessionsHelper.html">UserSessionsHelper</a></li>
				
					<li><a href="./UsersController.html">UsersController</a></li>
				
					<li><a href="./UsersHelper.html">UsersHelper</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">ProjectsController</h1>

		<div id="description">
			
		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="create-method" class="method-detail ">
				<a name="method-i-create"></a>

				<div class="method-heading">
				
					<span class="method-name">create</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Creates a project
</p>
					

					
					<div class="method-source-code"
						id="create-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 60</span>
60:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>
61:     <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:project</span>])
62:     <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">user_id</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">id</span>
63:     
64:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
65:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">save</span>
66:         <span class="ruby-comment cmt">#puts &quot;save successful&quot;</span>
67:         <span class="ruby-identifier">session</span>[<span class="ruby-value">:project_id</span>] = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">id</span>
68:         <span class="ruby-identifier">session</span>[<span class="ruby-value">:phase</span>] = <span class="ruby-value str">&quot;Planning&quot;</span>
69:         
70:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span> <span class="ruby-value">:controller=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;deliverables&quot;</span>, <span class="ruby-value">:project_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-ivar">@project</span>.<span class="ruby-identifier">id</span> }
71:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:created</span>, <span class="ruby-value">:location</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span> }
72:       <span class="ruby-keyword kw">else</span>
73:         <span class="ruby-comment cmt">#puts &quot;save failed&quot;</span>
74:         <span class="ruby-ivar">@lifecycle_array</span> = <span class="ruby-constant">RailblazersXmlParser</span>.<span class="ruby-identifier">get_lifecycle</span>
75:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;new&quot;</span> }
76:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">errors</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unprocessable_entity</span> }
77:       <span class="ruby-keyword kw">end</span>
78:     <span class="ruby-keyword kw">end</span>
79:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="destroy-method" class="method-detail ">
				<a name="method-i-destroy"></a>

				<div class="method-heading">
				
					<span class="method-name">destroy</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Deletes a project When deleting a project all the deliverables related to
the project will be deleted too
</p>
					

					
					<div class="method-source-code"
						id="destroy-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 107</span>
107:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy</span>
108:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_user_admin</span>
109:       <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
110:     <span class="ruby-keyword kw">else</span>
111:       <span class="ruby-ivar">@project</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
112:     <span class="ruby-keyword kw">end</span>
113:     <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">deliverables</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span> <span class="ruby-identifier">d</span>.<span class="ruby-identifier">destroy</span>  }
114:     <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">destroy</span>
115: 
116:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
117:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">projects_url</span>) }
118:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">head</span> <span class="ruby-value">:ok</span> }
119:     <span class="ruby-keyword kw">end</span>
120:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="edit-method" class="method-detail ">
				<a name="method-i-edit"></a>

				<div class="method-heading">
				
					<span class="method-name">edit</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Edit an existing project. If the current user is admin. He can edit all the
projects in the system. If it is regular user, PET will only allow this
type of user to access the project belongs to the user
</p>
					

					
					<div class="method-source-code"
						id="edit-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 51</span>
51:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">edit</span>
52:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_user_admin</span>
53:       <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
54:     <span class="ruby-keyword kw">else</span>
55:       <span class="ruby-ivar">@project</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
56:     <span class="ruby-keyword kw">end</span>
57:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="error-method" class="method-detail ">
				<a name="method-i-error"></a>

				<div class="method-heading">
				
					<span class="method-name">error</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="error-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 45</span>
45:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error</span>
46:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="index-method" class="method-detail ">
				<a name="method-i-index"></a>

				<div class="method-heading">
				
					<span class="method-name">index</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Displays all the projects on the <a href="Project.html">Project</a> Index
page it will only display projects belongs to the current user This
prevents the user from guessing the url
</p>
					

					
					<div class="method-source-code"
						id="index-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 6</span>
 6:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
 7:     <span class="ruby-ivar">@projects</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">all</span>
 8: 
 9:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
10:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment cmt"># index.html.erb</span>
11:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@projects</span> }
12:     <span class="ruby-keyword kw">end</span>
13:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="is-num--method" class="method-detail ">
				<a name="method-i-is_num%3F"></a>

				<div class="method-heading">
				
					<span class="method-name">is_num?</span><span
						class="method-args">(s)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="is-num--source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 175</span>
175:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_num?</span>(<span class="ruby-identifier">s</span>)
176:     <span class="ruby-identifier">s</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">/\A[+-]?\d+?(\.\d+)?\Z/</span>) <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">false</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">true</span>
177:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="log-hours-method" class="method-detail ">
				<a name="method-i-log_hours"></a>

				<div class="method-heading">
				
					<span class="method-name">log_hours</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Action to log hours for a particular deliverable.
</p>
					

					
					<div class="method-source-code"
						id="log-hours-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 149</span>
149:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">log_hours</span>
150:     <span class="ruby-ivar">@project</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:project_id</span>])
151:     <span class="ruby-ivar">@target_del</span> = <span class="ruby-constant">Deliverable</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:deliverable_id</span>])
152:     <span class="ruby-ivar">@deliverables</span> = <span class="ruby-constant">Deliverable</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;project_id = ?&quot;</span>, <span class="ruby-identifier">params</span>[<span class="ruby-value">:project_id</span>]], <span class="ruby-value">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;phase&quot;</span>)
153:     <span class="ruby-ivar">@hours</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:deliverable</span>][<span class="ruby-value">:hours_logged</span>]
154: 
155:     <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@hours</span>.<span class="ruby-identifier">blank?</span>
156:       <span class="ruby-ivar">@target_del</span>.<span class="ruby-identifier">hours_logged</span> = <span class="ruby-ivar">@hours</span>
157:       <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;type of: '#{@hours.class}'&quot;</span>
158:       <span class="ruby-keyword kw">if</span> (<span class="ruby-ivar">@hours</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Float</span>) <span class="ruby-operator">||</span> (<span class="ruby-ivar">@hours</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Integer</span>)
159:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Number&quot;</span>
160:       <span class="ruby-keyword kw">else</span>
161:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Not number&quot;</span>
162:       <span class="ruby-keyword kw">end</span>
163:       
164:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@target_del</span>.<span class="ruby-identifier">save</span>
165:           <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-value str">&quot;Effort Updated&quot;</span>
166:         <span class="ruby-keyword kw">else</span>
167:           <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-value str">&quot;Error Saving! Changes discarded&quot;</span>
168:         <span class="ruby-keyword kw">end</span>
169:     <span class="ruby-keyword kw">else</span>
170:       <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-value str">&quot;Please enter a value before submitting&quot;</span>
171:     <span class="ruby-keyword kw">end</span>
172:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:projects</span>, <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:show</span>, <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:project_id</span>]
173:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="new-method" class="method-detail ">
				<a name="method-i-new"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Creates a new project
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 35</span>
35:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">new</span>
36:     <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">new</span>
37:     <span class="ruby-ivar">@lifecycle_array</span> = <span class="ruby-constant">RailblazersXmlParser</span>.<span class="ruby-identifier">get_lifecycle</span>
38:     <span class="ruby-ivar">@error_msg</span>
39:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
40:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment cmt"># new.html.erb</span>
41:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span> }
42:     <span class="ruby-keyword kw">end</span>
43:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="overview-method" class="method-detail ">
				<a name="method-i-overview"></a>

				<div class="method-heading">
				
					<span class="method-name">overview</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
View the project overview screen with phase/deliverable estimations
</p>
					

					
					<div class="method-source-code"
						id="overview-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 123</span>
123:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">overview</span>
124:     <span class="ruby-ivar">@project</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">find_by_id</span>(<span class="ruby-identifier">session</span>[<span class="ruby-value">:project_id</span>])
125:     <span class="ruby-ivar">@phase_efforts</span> = {}
126: 
127:     <span class="ruby-identifier">phases</span> = <span class="ruby-constant">RailblazersXmlParser</span>.<span class="ruby-identifier">get_phase</span>(<span class="ruby-ivar">@project</span>.<span class="ruby-identifier">lifecycle</span>)
128:     <span class="ruby-identifier">deliverables</span> = <span class="ruby-constant">Deliverable</span>.<span class="ruby-identifier">find_all_by_project_id</span>(<span class="ruby-ivar">@project</span>.<span class="ruby-identifier">id</span>)
129: 
130:     <span class="ruby-comment cmt"># For each phase, create a new Hash if it doesn't exist</span>
131:     <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-identifier">phases</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
132:       <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@phase_efforts</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">phases</span>[<span class="ruby-identifier">i</span>])
133:         <span class="ruby-ivar">@phase_efforts</span>[<span class="ruby-identifier">phases</span>[<span class="ruby-identifier">i</span>]] = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
134: 
135:         <span class="ruby-comment cmt"># Grab all deliverables in this phase, add it to our small hash</span>
136:         <span class="ruby-identifier">del_to_process</span> = <span class="ruby-identifier">deliverables</span>.<span class="ruby-identifier">find_all</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span> <span class="ruby-identifier">d</span>.<span class="ruby-identifier">phase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">phases</span>[<span class="ruby-identifier">i</span>] }
137:         <span class="ruby-identifier">del_to_process</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">target</span><span class="ruby-operator">|</span>
138:           <span class="ruby-ivar">@phase_efforts</span>[<span class="ruby-identifier">phases</span>[<span class="ruby-identifier">i</span>]][<span class="ruby-identifier">target</span>.<span class="ruby-identifier">id</span>] = [<span class="ruby-identifier">target</span>.<span class="ruby-identifier">name</span>,<span class="ruby-identifier">target</span>.<span class="ruby-identifier">estimated_effort</span>,<span class="ruby-identifier">target</span>.<span class="ruby-identifier">hours_logged</span>]
139:         <span class="ruby-keyword kw">end</span>
140:       <span class="ruby-keyword kw">end</span>
141:     <span class="ruby-keyword kw">end</span>
142: 
143:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
144:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span>
145:     <span class="ruby-keyword kw">end</span>
146:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="show-method" class="method-detail ">
				<a name="method-i-show"></a>

				<div class="method-heading">
				
					<span class="method-name">show</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Displays project details for the selected project The show page now shows a
list of deliverable and displays the effort for the deliverables
</p>
					

					
					<div class="method-source-code"
						id="show-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 18</span>
18:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">show</span>
19:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_user_admin</span>
20:       <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
21:     <span class="ruby-keyword kw">else</span>
22:       <span class="ruby-ivar">@project</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
23:     <span class="ruby-keyword kw">end</span>
24:     <span class="ruby-identifier">session</span>[<span class="ruby-value">:project_id</span>] = <span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>]
25:     <span class="ruby-ivar">@deliverables</span> = <span class="ruby-constant">Deliverable</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;project_id = ?&quot;</span>, <span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>]], <span class="ruby-value">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;phase&quot;</span>)
26: 
27:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
28:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment cmt"># show.html.erb</span>
29:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span> }
30:     <span class="ruby-keyword kw">end</span>
31:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="update-method" class="method-detail ">
				<a name="method-i-update"></a>

				<div class="method-heading">
				
					<span class="method-name">update</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Updates the selected project with the content as modified by the user
</p>
					

					
					<div class="method-source-code"
						id="update-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 82</span>
 82:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>
 83:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_user_admin</span>
 84:       <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
 85:     <span class="ruby-keyword kw">else</span>
 86:       <span class="ruby-ivar">@project</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
 87:     <span class="ruby-keyword kw">end</span>
 88: 
 89:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
 90:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:project</span>])
 91:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_user_admin</span>
 92:           <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">admin_projects_path</span>, <span class="ruby-value">:notice</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Project was successfully updated.'</span>) }
 93:         <span class="ruby-keyword kw">else</span>
 94:           <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-value">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;projects&quot;</span>, <span class="ruby-value">:notice</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Project was successfully updated.'</span>) }
 95:         <span class="ruby-keyword kw">end</span>
 96:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">head</span> <span class="ruby-value">:ok</span> }
 97:       <span class="ruby-keyword kw">else</span>
 98:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit&quot;</span> }
 99:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">errors</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unprocessable_entity</span> }
100:       <span class="ruby-keyword kw">end</span>
101:     <span class="ruby-keyword kw">end</span>
102:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

